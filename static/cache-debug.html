<!DOCTYPE html>
<html>
<head>
    <title>Cache Debug</title>
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <style>
        body { font-family: Arial; padding: 40px; background: #f0f0f0; }
        .box { background: white; padding: 30px; margin: 20px 0; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        .success { background: #d4edda; border-left: 5px solid #28a745; }
        .error { background: #f8d7da; border-left: 5px solid #dc3545; }
        button { padding: 15px 30px; font-size: 16px; margin: 10px; cursor: pointer; border: none; border-radius: 5px; }
        .btn-primary { background: #007bff; color: white; }
        .btn-danger { background: #dc3545; color: white; }
        code { background: #f4f4f4; padding: 2px 6px; border-radius: 3px; }
    </style>
</head>
<body>
    <h1>üîç Cache Diagnostic Page</h1>
    
    <div class="box">
        <h2>Current Status</h2>
        <p><strong>Timestamp:</strong> <span id="timestamp"></span></p>
        <p><strong>Page Load:</strong> <span id="loadCount"></span></p>
    </div>

    <div class="box success">
        <h2>‚úÖ If You Can See This Page</h2>
        <p>Your browser CAN load new content from the server!</p>
        <p>The problem is that Chrome is serving CACHED versions of the main page.</p>
    </div>

    <div class="box error">
        <h2>üö® The Fix - DO THIS NOW:</h2>
        <ol>
            <li><strong>Press F12</strong> to open Chrome DevTools</li>
            <li>Go to the <strong>Application</strong> tab</li>
            <li>Click <strong>"Clear storage"</strong> on the left</li>
            <li>Check <strong>ALL boxes</strong> (Cache, Cookies, etc.)</li>
            <li>Click <strong>"Clear site data"</strong> button</li>
            <li>Close DevTools</li>
            <li>Press <strong>Ctrl + Shift + R</strong> to hard reload</li>
        </ol>
    </div>

    <div class="box">
        <h2>Alternative Method - Empty Cache</h2>
        <ol>
            <li>Keep DevTools open (F12)</li>
            <li><strong>Right-click</strong> the reload button (‚Üª) in Chrome toolbar</li>
            <li>Select <strong>"Empty Cache and Hard Reload"</strong></li>
        </ol>
    </div>

    <div class="box">
        <h2>Nuclear Option - Delete Everything</h2>
        <button class="btn-danger" onclick="clearEverything()">üóëÔ∏è Clear All Chrome Data for This Site</button>
        <p><small>This will clear cookies, cache, localStorage, everything!</small></p>
    </div>

    <div class="box">
        <h2>Test Links</h2>
        <button class="btn-primary" onclick="window.location.href='/'">Go to Main Page (may still be cached)</button>
        <button class="btn-primary" onclick="window.location.href='/?v=' + Date.now()">Go to Main Page (cache-busted)</button>
        <button class="btn-primary" onclick="window.location.href='/static/test-buttons.html'">View Test Buttons Page</button>
    </div>

    <div class="box">
        <h2>What Should You See on Main Page?</h2>
        <p><strong>1. At the TOP</strong> (right after the title):</p>
        <pre style="background: #f8f9fa; padding: 15px; border-radius: 5px;">ü§ñ Active Model: [Original (Ensemble) ‚ñº]  üîÑ</pre>
        
        <p><strong>2. After making a prediction</strong> (scroll down below results table):</p>
        <pre style="background: #f8f9fa; padding: 15px; border-radius: 5px;">
üéØ Help Improve the Model
Was this prediction correct? Help us retrain the model with your feedback!

What is the actual result?
[‚úÖ WATER IS POTABLE]  [‚õî WATER IS NOT POTABLE]
        </pre>
    </div>

    <script>
        document.getElementById('timestamp').textContent = new Date().toLocaleString();
        
        let loadCount = localStorage.getItem('loadCount') || 0;
        loadCount = parseInt(loadCount) + 1;
        localStorage.setItem('loadCount', loadCount);
        document.getElementById('loadCount').textContent = loadCount + ' times';

        function clearEverything() {
            // Clear localStorage
            localStorage.clear();
            
            // Clear sessionStorage
            sessionStorage.clear();
            
            // Clear cookies
            document.cookie.split(";").forEach(function(c) { 
                document.cookie = c.replace(/^ +/, "").replace(/=.*/, "=;expires=" + new Date().toUTCString() + ";path=/"); 
            });
            
            // Try to unregister service workers
            if ('serviceWorker' in navigator) {
                navigator.serviceWorker.getRegistrations().then(function(registrations) {
                    for(let registration of registrations) {
                        registration.unregister();
                    }
                });
            }
            
            alert('‚úÖ All data cleared! Now press Ctrl+Shift+R to hard reload.');
            location.reload(true);
        }
    </script>
</body>
</html>
